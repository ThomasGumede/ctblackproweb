{% extends '_application.html' %}
{% load static %}
{% block app_title %}
Personal Information
{% endblock app_title %}

{% block app_content %}

<div class="tab-contents">
    <!-- content 1 -->
    <div class="transition-all duration-300">
        {% if forms.errors or form.errors %}
        <div class="w-full mx-auto">
            <div class="bg-red-50 border-l-8 border-red-900">
                <div class="flex items-center">
                    <div class="p-2">
                        <div class="flex items-center">
                            <div class="ml-2">
                                <svg class="h-8 w-8 text-red-900 mr-2 cursor-pointer" xmlns="http://www.w3.org/2000/svg"
                                    fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </div>
                            <p class="px-6 py-4 text-red-900 font-semibold text-lg">Please fix the
                                following
                                errors.</p>
                        </div>
        
                        <ul class="px-16 mb-4">
                            {% if forms.non_field_errors %}
                            <li class="text-md font-bold p-1 list-none text-red-500 text-sm">{{forms.non_field_errors.as_text}}
                            </li>
                            {% endif %}
                            {% if form.non_field_errors %}
                            <li class="text-md font-bold p-1 list-none text-red-500 text-sm">
                                {{form.non_field_errors}}</li>
                            {% endif %}
        
                            {% for key, value in form.errors.items %}
                            <li class="text-md font-bold p-1 list-none text-red-500 text-sm flex items-center gap-4">
                                {{key|escape}}: {{value|escape}}</li>
                            {% endfor %}
        
                            {% for form2 in forms %}
                            {% for field in form2 %}
                            {% for err in field.errors %}
                            <li class="text-md font-bold p-1 list-none text-red-500 text-sm flex items-center gap-4">
                                {{field.label}}:
                                {{err}}</li>
                            {% endfor%}
                            {% for err in field.non_field_errors %}
                            <li class="text-md font-bold p-1 list-none text-red-500 text-sm flex items-center gap-4">{{err}}
                            </li>
                            {% endfor%}
                            {% endfor %}
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
        <form method="post" enctype="multipart/form-data" class="form-primary add-property-form bg-white text-sm lg:text-base">
            {% csrf_token %}

            <!-- Property Price -->
            <div>
                <h5 class="text-sm md:text-15px lg:text-base font-bold leading-1.3 text-heading-color mb-15px">
                    <span class="leading-1.3 md:leading-1.3 lg:leading-1.3">
                        Personal Information</span>
                </h5>
                <div class="w-full">
                    <div class="relative w-full mb-3">
                        <label for="id_image">
                            Profile picture*
                        </label>
                        {{form.profile_image}}
                        <div class="w-full border rounded-md bg-white border-dotted p-6">
                            <div class="flex items-center flex-col md:flex-row gap-4 w-full justify-between">
                                <div class="flex items-center space-x-4">
                                    <div id="img_container" data-image="{% if form.profile_image.value %}{{form.profile_image.value.url}}{% endif %}"
                                        class="h-16 w-20 overflow-hidden rounded bg-gray-300">
                                        <div id="no_image"></div>
                                    </div>
                                    <div class="space-y-1">
                                        <p class="text-xs font-bold text-gray-500">Upload image
                                            of you.</p>
                                        <p class="text-xs font-light text-gray-500">SVG, PNG,
                                            JPG, JPEG or GIF</p>
                                    </div>
                                </div>
                                <div id="pick_image" class="border p-2 cursor-pointer text-center text-custom-text">
                                    <p class="text-sm">Browser</p>
                                </div>
                            </div>
                        </div>

                        <span
                            class="text-[11px] text-custom-tertiary block font-normal lowercase">{{form.profile_image.help_text}}</span>
                        {% if form.profile_image.errors %}
                        <span
                            class="text-[11px] text-red-500 block font-normal lowercase">{{form.profile_image.errors.as_text}}</span>
                        {% endif %}
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-30px mb-35px">
                    <div class="relative">
                        <input type="text" placeholder="First Name*" id="id_first_name" name="first_name"
                            value="{% if user.first_name %}{{user.first_name}}{% endif %}"
                            class="text-paragraph-color pl-5 pr-50px outline-none border-2 border-border-color-9 focus:border focus:border-secondary-color h-65px block w-full rounded-none placeholder:text-paragraph-color placeholder:text-sm">
                        <span class="absolute top-1/2 -translate-y-1/2 right-4">
                            <i class="fas fa-pencil text-sm lg:text-base text-secondary-color font-bold"></i>
                        </span>
                        <span
                            class="text-[11px] text-custom-tertiary block font-normal lowercase">{{form.first_name.help_text}}</span>
                        {% if form.first_name.errors %}
                        <span
                            class="text-[11px] text-red-500 block font-normal lowercase">{{form.first_name.errors.as_text}}</span>
                        {% endif %}
                    </div>

                    <div class="relative">
                        <input type="text" id="id_last_name" name="last_name"
                            value="{% if user.last_name %}{{user.last_name}}{% endif %}" placeholder="Last Name*"
                            class="text-paragraph-color pl-5 pr-50px outline-none border-2 border-border-color-9 focus:border focus:border-secondary-color h-65px block w-full rounded-none placeholder:text-paragraph-color placeholder:text-sm">
                        <span class="absolute top-1/2 -translate-y-1/2 right-4">
                            <i class="fas fa-pencil text-sm lg:text-base text-secondary-color font-bold"></i>
                        </span>
                        <span
                            class="text-[11px] text-custom-tertiary block font-normal lowercase">{{form.last_name.help_text}}</span>
                        {% if form.last_name.errors %}
                        <span
                            class="text-[11px] text-red-500 block font-normal lowercase">{{form.last_name.errors.as_text}}</span>
                        {% endif %}
                    </div>

                    <div class="relative block">
                        {{form.title}}
                        <span class="text-[11px] text-custom-tertiary block font-normal lowercase">Select
                            Your Title</span>
                        {% if form.title.errors %}
                        <span
                            class="text-[11px] text-red-500 block font-normal lowercase">{{form.title.errors.as_text}}</span>
                        {% endif %}
                    </div>
                    <div class="relative block">
                        {{form.race}}
                        <span class="text-[11px] text-custom-tertiary block font-normal lowercase">Select
                            Your Race</span>
                        {% if form.race.errors %}
                        <span
                            class="text-[11px] text-red-500 block font-normal lowercase">{{form.race.errors.as_text}}</span>
                        {% endif %}
                    </div>
                    <div class="relative block">
                        {{form.gender}}
                        <span class="text-[11px] text-custom-tertiary block font-normal lowercase">Select
                            Your Gender. {{form.gender.help_text}}</span>
                        {% if form.gender.errors %}
                        <span
                            class="text-[11px] text-red-500 block font-normal lowercase">{{form.gender.errors.as_text}}</span>
                        {% endif %}
                    </div>
                    <div class="relative">
                        <input type="text" placeholder="HNA Membership number" id="id_hna_membership_number"
                            name="hna_membership_number"
                            value="{% if user.hna_membership_number %}{{user.hna_membership_number}}{% endif %}"
                            class="text-paragraph-color pl-5 pr-50px outline-none border-2 border-border-color-9 focus:border focus:border-secondary-color h-65px block w-full rounded-none placeholder:text-paragraph-color placeholder:text-sm">
                        <span class="absolute top-1/2 -translate-y-1/2 right-4">
                            <i class="fas fa-pencil text-sm lg:text-base text-secondary-color font-bold"></i>
                        </span>
                        <span
                            class="text-[11px] text-custom-tertiary block font-normal lowercase">{{form.hna_membership_number.help_text}}</span>
                        {% if form.hna_membership_number.errors %}
                        <span
                            class="text-[11px] text-red-500 block font-normal lowercase">{{form.hna_membership_number.errors.as_text}}</span>
                        {% endif %}
                    </div>

                    <div class="relative">
                        <input type="email" placeholder="Email*" id="id_email" name="email"
                            value="{% if user.email %}{{user.email}}{% endif %}"
                            class="text-paragraph-color pl-5 pr-50px outline-none border-2 border-border-color-9 focus:border focus:border-secondary-color h-65px block w-full rounded-none placeholder:text-paragraph-color placeholder:text-sm">
                        <span class="absolute top-1/2 -translate-y-1/2 right-4">
                            <i class="fas fa-pencil text-sm lg:text-base text-secondary-color font-bold"></i>
                        </span>
                        <span
                            class="text-[11px] text-custom-tertiary block font-normal lowercase">{{form.email.help_text}}</span>
                        {% if form.email.errors %}
                        <span
                            class="text-[11px] text-red-500 block font-normal lowercase">{{form.email.errors.as_text}}</span>
                        {% endif %}
                    </div>

                    <div class="relative">
                        <input type="text" placeholder="Cell Phone" id="id_phone" name="phone"
                            value="{% if user.phone %}{{user.phone}}{% endif %}"
                            class="text-paragraph-color pl-5 pr-50px outline-none border-2 border-border-color-9 focus:border focus:border-secondary-color h-65px block w-full rounded-none placeholder:text-paragraph-color placeholder:text-sm">
                        <span class="absolute top-1/2 -translate-y-1/2 right-4">
                            <i class="fas fa-pencil text-sm lg:text-base text-secondary-color font-bold"></i>
                        </span>
                        <span
                            class="text-[11px] text-custom-tertiary block font-normal lowercase">{{form.phone.help_text}}</span>
                        {% if form.phone.errors %}
                        <span
                            class="text-[11px] text-red-500 block font-normal lowercase">{{form.phone.errors.as_text}}</span>
                        {% endif %}
                    </div>


                </div>
                <div class="relative mb-35px">
                    <textarea placeholder="Tell us a little bit about your professional or business" id="id_biography"
                        name="biography"
                        class="min-h-[150px] text-paragraph-color pl-5 pr-50px py-15px outline-none border-2 border-border-color-9 focus:border focus:border-secondary-color h-65px block w-full rounded-none placeholder:text-paragraph-color placeholder:text-sm">{% if user.biography %}{{user.biography}}{% endif %}</textarea>
                    <span class="absolute top-[30px] -translate-y-1/2 right-4">
                        <i class="fas fa-pencil text-sm lg:text-base text-secondary-color font-bold"></i>
                    </span>
                    <span
                        class="text-[11px] text-custom-tertiary block font-normal lowercase">{{form.biography.help_text}}</span>
                    {% if form.biography.errors %}
                    <span
                        class="text-[11px] text-red-500 block font-normal lowercase">{{form.biography.errors.as_text}}</span>
                    {% endif %}
                </div>
                <div class="relative mb-35px">
                    <input type="text" placeholder="*Address (mandatory)" id="id_address" name="address" value="{{form.address.value}}"
                        class="text-paragraph-color pl-5 pr-50px outline-none border-2 border-border-color-9 focus:border focus:border-secondary-color h-65px block w-full rounded-none placeholder:text-paragraph-color placeholder:text-sm">
                    <span class="absolute top-1/2 -translate-y-1/2 right-4">
                        <i class="fas fa-pencil text-sm lg:text-base text-secondary-color font-bold"></i>
                    </span>
                    <span
                        class="text-[11px] text-custom-tertiary block font-normal lowercase">{{form.address.help_text}}</span>
                    {% if form.address.errors %}
                    <span
                        class="text-[11px] text-red-500 block font-normal lowercase">{{form.address.errors.as_text}}</span>
                    {% endif %}
                </div>
                <div class="relative mb-35px">
                    <input type="url" placeholder="LinkedIn Profile Url e.g https://linked.com/@profile"
                        id="id_linkedIn" name="linkedIn" value="{{form.linkedIn.value}}"
                        class="text-paragraph-color pl-5 pr-50px outline-none border-2 border-border-color-9 focus:border focus:border-secondary-color h-65px block w-full rounded-none placeholder:text-paragraph-color placeholder:text-sm">
                    <span class="absolute top-1/2 -translate-y-1/2 right-4">
                        <i class="fas fa-pencil text-sm lg:text-base text-secondary-color font-bold"></i>
                    </span>
                    <span
                        class="text-[11px] text-custom-tertiary block font-normal lowercase">{{form.linkedIn.help_text}}</span>
                    {% if form.linkedIn.errors %}
                    <span
                        class="text-[11px] text-red-500 block font-normal lowercase">{{form.linkedIn.errors.as_text}}</span>
                    {% endif %}
                </div>
            </div>

            
            <!-- submit -->
            <div class="bg-white text-center">
                <div>
                    <p class="text-sm lg:text-base mb-5 lg:mb-6">
                        <span class="leading-1.8 lg:leading-1.8">By clicking 'next step', you agree to our:
                            terms & conditions,
                            our privacy policy and you understand and agree with our membership rates and
                            policy</span>
                    </p>

                </div>
            </div>
            <div class="grid gap-5 justify-start">

                <h5
                    class="uppercase text-sm md:text-base text-white relative group whitespace-nowrap font-normal mb-0 transition-all duration-300 border border-secondary-color hover:border-heading-color inline-block z-0">
                    <span
                        class="inline-block absolute top-0 right-0 w-full h-full bg-secondary-color group-hover:bg-black -z-1 group-hover:w-0 transition-all duration-300"></span>
                    <button type="submit"
                        class="relative z-1 px-5 md:px-25px lg:px-10 py-10px md:py-15px lg:py-17px group-hover:text-heading-color leading-1.5 uppercase">
                        Next Step
                    </button>
                </h5>

            </div>
        </form>
    </div>
</div>


{% endblock app_content %}


{% block js %}
<script>
    window.onload = () => {
        const file_picker = document.querySelector("#id_profile_image"),
            pick_image = document.querySelector("#pick_image")
        const no_image = document.querySelector("#no_image");
        const img_container = document.querySelector("#img_container")
        const img = document.querySelector("#img")

        if (img_container.getAttribute("data-image")) {

            img_container.removeChild(no_image);
            img_container.innerHTML += `
                        <img
                            src="${img_container.getAttribute("data-image")}"
                            alt="{{request.user.first_name}}"
                            class="w-full h-full object-cover"
                            id="img"
                        />
                    `
        }
        pick_image.addEventListener('click', () => {
            file_picker.click()
        })

        file_picker.onchange = ({target}) => {

            var file = target.files[0]
            if (file) {
                // console.log(no_image)
                if (no_image) {

                    img_container.removeChild(no_image);
                    img_container.innerHTML += `
                        <img
                            src="${window.URL.createObjectURL(file)}"
                            alt="{{request.user.first_name}}"
                            class="w-full h-full object-cover"
                            id="img"
                        />
                    `
                } else {
                    img.src = window.URL.createObjectURL(file)
                }

            } else {
                alert("no file selected")
            }

        };

    }

</script>
{% endblock js %}